<!DOCTYPE html>
<html>
<head>
	<title>AI Chatbot</title>
</head>
<body>
	<div id="chatbot">
		<div id="messages">
			<div class="bot-message">
				<p>Hello, how can I help you?</p>
			</div>
		</div>
		<div id="input">
			<input type="text" id="input-box" placeholder="Type your message here">
			<button id="send-btn" onclick="sendMessage()">Send</button>
		</div>
	</div>

	<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@3.9.0/dist/tf.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/universal-sentence-encoder@4.2.0/dist/universal-sentence-encoder.min.js"></script>

	<script>
		const botMessages = document.getElementById('messages');

		async function getResponse() {
			const message = document.getElementById('input-box').value;
			document.getElementById('input-box').value = '';

			const model = await use.load();

			const response = await model.embed([message]).array();
			const messageEmbedding = response[0];

			// Add your own messages here
			const messageEmbeddings = [
				// "Hello" response
				tf.tensor1d([0.365558475, -0.732019544, -0.000687688931, ...]),
				// "How are you?" response
				tf.tensor1d([-0.645890772, 0.216420472, 0.63576746, ...]),
				// "What is your name?" response
				tf.tensor1d([0.64176935, -0.608485639, -0.472926974, ...])
			];

			const similarities = messageEmbeddings.map(messageEmbedding =>
				messageEmbedding.dot(messageEmbedding).mul(messageEmbedding.dot(messageEmbedding))
				.sub(messageEmbedding.dot(messageEmbedding)).sum().arraySync()
			);

			const mostSimilarIndex = similarities.indexOf(Math.max(...similarities));

			const responses = [
				"Hello!",
				"I'm doing well, thank you!",
				"My name is AI Chatbot."
			];

			addBotMessage(responses[mostSimilarIndex]);
		}

		function addBotMessage(message) {
			const messageElement = document.createElement('div');
			messageElement.classList.add('bot-message');
			messageElement.innerHTML = `<p>${message}</p>`;
			botMessages.appendChild(messageElement);
			botMessages.scrollTop = botMessages.scrollHeight;
		}

		function sendMessage() {
			const message = document.getElementById('input-box').value;
			if (message) {
				addUserMessage(message);
				getResponse();
			}
		}

		function addUserMessage(message) {
			const messageElement = document.createElement('div');
			messageElement.classList.add('user-message');
			messageElement.innerHTML = `<p>${message}</p>`;
			botMessages.appendChild(messageElement);
			botMessages.scrollTop = botMessages.scrollHeight;
		}

		document.getElementById('input-box').addEventListener('keyup', function(event) {
			if (event.keyCode === 13) {
				event.preventDefault();
				document.getElementById('send-btn').click();
			}
		});
	</script>
</body>
</html>

<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>AI Chatbot</title>
  </head>
  <body>
    <h1>AI Chatbot</h1>
    <p>Enter your message below:</p>
    <input type="text" id="chat-input" />
    <button onclick="getResponse()">Send</button>
    <ul id="chat-output"></ul>

    <!-- Load TensorFlow.js library -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
    <!-- Load the Universal Sentence Encoder -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/universal-sentence-encoder"></script>

    <script>
      // Load the Universal Sentence Encoder model
      async function loadModel() {
        const model = await use.load();
        return model;
      }

      let model;
      loadModel().then((loadedModel) => {
        model = loadedModel;
        console.log("Model loaded successfully.");
      });

      // Get response from the AI
      function getResponse() {
        const input = document.getElementById("chat-input").value;

        if (input === "") return;

        // Encode the input text into a tensor
        const tensor = model.embed([input]);

        // Get a response from the AI
        model
          .embed(["Hello, how can I help you?"])
          .concat(tensor)
          .array()
          .then((embeddings) => {
            // Compute the cosine similarity between the two embeddings
            const similarity = embeddings[0].dot(embeddings[1]) / (embeddings[0].norm() * embeddings[1].norm());
            console.log(similarity);

            // If the similarity is above a certain threshold, assume that the user is asking the same question
            if (similarity >= 0.5) {
              document.getElementById("chat-output").innerHTML += "<li>You: " + input + "</li><li>AI: " + "Hello, how can I help you?" + "</li>";
            } else {
              document.getElementById("chat-output").innerHTML += "<li>You: " + input + "</li><li>AI: " + "I'm sorry, I don't understand." + "</li>";
            }
          });

        // Clear the input field
        document.getElementById("chat-input").value = "";
      }
    </script>
  </body>
</html>
